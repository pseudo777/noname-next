(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const gt=!1;var nn=Array.isArray,ir=Array.prototype.indexOf,ct=Array.from,sr=Object.defineProperty,We=Object.getOwnPropertyDescriptor,ar=Object.getOwnPropertyDescriptors,lr=Object.prototype,fr=Array.prototype,rn=Object.getPrototypeOf,Bt=Object.isExtensible;function ur(t){for(var e=0;e<t.length;e++)t[e]()}function sn(){var t,e,n=new Promise((r,i)=>{t=r,e=i});return{promise:n,resolve:t,reject:e}}const F=2,Tt=4,St=8,or=1<<24,_e=16,pe=32,Re=64,dt=128,se=512,L=1024,K=2048,oe=4096,J=8192,we=16384,Ct=32768,Le=65536,jt=1<<17,an=1<<18,Be=1<<19,cr=1<<20,ve=1<<25,Ae=32768,mt=1<<21,At=1<<22,ye=1<<23,st=Symbol("$state"),dr=Symbol(""),Fe=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function vr(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function hr(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function _r(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function pr(t){throw new Error("https://svelte.dev/e/effect_orphan")}function gr(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function mr(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function wr(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function yr(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function br(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Er=1,xr=2,ln=4,kr=8,Tr=16,Sr=1,Cr=2,P=Symbol(),Ar="http://www.w3.org/1999/xhtml";function qr(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function fn(t){return t===this.v}function Mr(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function un(t){return!Mr(t,this.v)}let Rr=!1,te=null;function ze(t){te=t}function et(t,e=!1,n){te={p:te,i:!1,c:null,e:null,s:t,x:null,l:null}}function tt(t){var e=te,n=e.e;if(n!==null){e.e=null;for(var r of n)xn(r)}return e.i=!0,te=e.p,{}}function on(){return!0}let Ie=[];function Dr(){var t=Ie;Ie=[],ur(t)}function je(t){if(Ie.length===0){var e=Ie;queueMicrotask(()=>{e===Ie&&Dr()})}Ie.push(t)}function cn(t){var e=x;if(e===null)return w.f|=ye,t;if((e.f&Ct)===0){if((e.f&dt)===0)throw t;e.b.error(t)}else Ue(t,e)}function Ue(t,e){for(;e!==null;){if((e.f&dt)!==0)try{e.b.error(t);return}catch(n){t=n}e=e.parent}throw t}const it=new Set;let A=null,ee=null,ae=[],qt=null,wt=!1;class le{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#l=null;#s=new Set;#i=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#r>0}process(e){ae=[],this.apply();var n={parent:null,effect:null,effects:[],render_effects:[]};for(const r of e)this.#a(r,n);this.is_fork||this.#o(),this.is_deferred()?(this.#f(n.effects),this.#f(n.render_effects)):(A=null,Vt(n.render_effects),Vt(n.effects),this.#l?.resolve()),ee=null}#a(e,n){e.f^=L;for(var r=e.first;r!==null;){var i=r.f,s=(i&(pe|Re))!==0,a=s&&(i&L)!==0,f=a||(i&J)!==0||this.skipped_effects.has(r);if((r.f&dt)!==0&&r.b?.is_pending()&&(n={parent:n,effect:r,effects:[],render_effects:[]}),!f&&r.fn!==null){s?r.f^=L:(i&Tt)!==0?n.effects.push(r):rt(r)&&((r.f&_e)!==0&&this.#s.add(r),$e(r));var l=r.first;if(l!==null){r=l;continue}}var u=r.parent;for(r=r.next;r===null&&u!==null;)u===n.effect&&(this.#f(n.effects),this.#f(n.render_effects),n=n.parent),r=u.next,u=u.parent}}#f(e){for(const n of e)(n.f&K)!==0?this.#s.add(n):(n.f&oe)!==0&&this.#i.add(n),this.#u(n.deps),z(n,L)}#u(e){if(e!==null)for(const n of e)(n.f&F)===0||(n.f&Ae)===0||(n.f^=Ae,this.#u(n.deps))}capture(e,n){this.previous.has(e)||this.previous.set(e,n),(e.f&ye)===0&&(this.current.set(e,e.v),ee?.set(e,e.v))}activate(){A=this,this.apply()}deactivate(){A===this&&(A=null,ee=null)}flush(){if(this.activate(),ae.length>0){if(Nr(),A!==null&&A!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#o(){if(this.#r===0){for(const e of this.#e)e();this.#e.clear()}this.#n===0&&this.#c()}#c(){if(it.size>1){this.previous.clear();var e=ee,n=!0,r={parent:null,effect:null,effects:[],render_effects:[]};for(const s of it){if(s===this){n=!1;continue}const a=[];for(const[l,u]of this.current){if(s.current.has(l))if(n&&u!==s.current.get(l))s.current.set(l,u);else continue;a.push(l)}if(a.length===0)continue;const f=[...s.current.keys()].filter(l=>!this.current.has(l));if(f.length>0){var i=ae;ae=[];const l=new Set,u=new Map;for(const c of a)dn(c,f,l,u);if(ae.length>0){A=s,s.apply();for(const c of ae)s.#a(c,r);s.deactivate()}ae=i}}A=null,ee=e}this.committed=!0,it.delete(this)}increment(e){this.#n+=1,e&&(this.#r+=1)}decrement(e){this.#n-=1,e&&(this.#r-=1),this.revive()}revive(){for(const e of this.#s)this.#i.delete(e),z(e,K),qe(e);for(const e of this.#i)z(e,oe),qe(e);this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#l??=sn()).promise}static ensure(){if(A===null){const e=A=new le;it.add(A),le.enqueue(()=>{A===e&&e.flush()})}return A}static enqueue(e){je(e)}apply(){}}function Nr(){var t=Se;wt=!0;var e=null;try{var n=0;for(ut(!0);ae.length>0;){var r=le.ensure();if(n++>1e3){var i,s;Or()}r.process(ae),be.clear()}}finally{wt=!1,ut(t),qt=null}}function Or(){try{gr()}catch(t){Ue(t,qt)}}let de=null;function Vt(t){var e=t.length;if(e!==0){for(var n=0;n<e;){var r=t[n++];if((r.f&(we|J))===0&&rt(r)&&(de=new Set,$e(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?Cn(r):r.fn=null),de?.size>0)){be.clear();for(const i of de){if((i.f&(we|J))!==0)continue;const s=[i];let a=i.parent;for(;a!==null;)de.has(a)&&(de.delete(a),s.push(a)),a=a.parent;for(let f=s.length-1;f>=0;f--){const l=s[f];(l.f&(we|J))===0&&$e(l)}}de.clear()}}de=null}}function dn(t,e,n,r){if(!n.has(t)&&(n.add(t),t.reactions!==null))for(const i of t.reactions){const s=i.f;(s&F)!==0?dn(i,e,n,r):(s&(At|_e))!==0&&(s&K)===0&&vn(i,e,r)&&(z(i,K),qe(i))}}function vn(t,e,n){const r=n.get(t);if(r!==void 0)return r;if(t.deps!==null)for(const i of t.deps){if(e.includes(i))return!0;if((i.f&F)!==0&&vn(i,e,n))return n.set(i,!0),!0}return n.set(t,!1),!1}function qe(t){for(var e=qt=t;e.parent!==null;){e=e.parent;var n=e.f;if(wt&&e===x&&(n&_e)!==0&&(n&an)===0)return;if((n&(Re|pe))!==0){if((n&L)===0)return;e.f^=L}}ae.push(e)}function Fr(t){let e=0,n=Me(0),r;return()=>{Qe()&&(d(n),kn(()=>(e===0&&(r=Ln(()=>t(()=>Xe(n)))),e+=1,()=>{je(()=>{e-=1,e===0&&(r?.(),r=void 0,Xe(n))})})))}}var Ir=Le|Be|dt;function Pr(t,e,n){new Lr(t,e,n)}class Lr{parent;#e=!1;#t;#n=null;#r;#l;#s;#i=null;#a=null;#f=null;#u=null;#o=null;#c=0;#d=0;#h=!1;#v=null;#w=Fr(()=>(this.#v=Me(this.#c),()=>{this.#v=null}));constructor(e,n,r){this.#t=e,this.#r=n,this.#l=r,this.parent=x.b,this.#e=!!this.#r.pending,this.#s=Nt(()=>{x.b=this;{var i=this.#g();try{this.#i=$(()=>r(i))}catch(s){this.error(s)}this.#d>0?this.#p():this.#e=!1}return()=>{this.#o?.remove()}},Ir)}#y(){try{this.#i=$(()=>this.#l(this.#t))}catch(e){this.error(e)}this.#e=!1}#b(){const e=this.#r.pending;e&&(this.#a=$(()=>e(this.#t)),le.enqueue(()=>{var n=this.#g();this.#i=this.#_(()=>(le.ensure(),$(()=>this.#l(n)))),this.#d>0?this.#p():(Te(this.#a,()=>{this.#a=null}),this.#e=!1)}))}#g(){var e=this.#t;return this.#e&&(this.#o=Ee(),this.#t.before(this.#o),e=this.#o),e}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#_(e){var n=x,r=w,i=te;ce(this.#s),V(this.#s),ze(this.#s.ctx);try{return e()}catch(s){return cn(s),null}finally{ce(n),V(r),ze(i)}}#p(){const e=this.#r.pending;this.#i!==null&&(this.#u=document.createDocumentFragment(),this.#u.append(this.#o),Mn(this.#i,this.#u)),this.#a===null&&(this.#a=$(()=>e(this.#t)))}#m(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#m(e);return}this.#d+=e,this.#d===0&&(this.#e=!1,this.#a&&Te(this.#a,()=>{this.#a=null}),this.#u&&(this.#t.before(this.#u),this.#u=null))}update_pending_count(e){this.#m(e),this.#c+=e,this.#v&&He(this.#v,this.#c)}get_effect_pending(){return this.#w(),d(this.#v)}error(e){var n=this.#r.onerror;let r=this.#r.failed;if(this.#h||!n&&!r)throw e;this.#i&&(G(this.#i),this.#i=null),this.#a&&(G(this.#a),this.#a=null),this.#f&&(G(this.#f),this.#f=null);var i=!1,s=!1;const a=()=>{if(i){qr();return}i=!0,s&&br(),le.ensure(),this.#c=0,this.#f!==null&&Te(this.#f,()=>{this.#f=null}),this.#e=this.has_pending_snippet(),this.#i=this.#_(()=>(this.#h=!1,$(()=>this.#l(this.#t)))),this.#d>0?this.#p():this.#e=!1};var f=w;try{V(null),s=!0,n?.(e,a),s=!1}catch(l){Ue(l,this.#s&&this.#s.parent)}finally{V(f)}r&&je(()=>{this.#f=this.#_(()=>{le.ensure(),this.#h=!0;try{return $(()=>{r(this.#t,()=>e,()=>a)})}catch(l){return Ue(l,this.#s.parent),null}finally{this.#h=!1}})})}}function zr(t,e,n,r){const i=Mt;if(n.length===0&&t.length===0){r(e.map(i));return}var s=A,a=x,f=Ur();function l(){Promise.all(n.map(u=>Hr(u))).then(u=>{f();try{r([...e.map(i),...u])}catch(c){(a.f&we)===0&&Ue(c,a)}s?.deactivate(),lt()}).catch(u=>{Ue(u,a)})}t.length>0?Promise.all(t).then(()=>{f();try{return l()}finally{s?.deactivate(),lt()}}):l()}function Ur(){var t=x,e=w,n=te,r=A;return function(s=!0){ce(t),V(e),ze(n),s&&r?.activate()}}function lt(){ce(null),V(null),ze(null)}function Mt(t){var e=F|K,n=w!==null&&(w.f&F)!==0?w:null;return x!==null&&(x.f|=Be),{ctx:te,deps:null,effects:null,equals:fn,f:e,fn:t,reactions:null,rv:0,v:P,wv:0,parent:n??x,ac:null}}function Hr(t,e){let n=x;n===null&&vr();var r=n.b,i=void 0,s=Me(P),a=!w,f=new Map;return $r(()=>{var l=sn();i=l.promise;try{Promise.resolve(t()).then(l.resolve,l.reject).then(()=>{u===A&&u.committed&&u.deactivate(),lt()})}catch(o){l.reject(o),lt()}var u=A;if(a){var c=!r.is_pending();r.update_pending_count(1),u.increment(c),f.get(u)?.reject(Fe),f.delete(u),f.set(u,l)}const v=(o,h=void 0)=>{if(u.activate(),h)h!==Fe&&(s.f|=ye,He(s,h));else{(s.f&ye)!==0&&(s.f^=ye),He(s,o);for(const[y,R]of f){if(f.delete(y),y===u)break;R.reject(Fe)}}a&&(r.update_pending_count(-1),u.decrement(c))};l.promise.then(v,o=>v(null,o||"unknown"))}),En(()=>{for(const l of f.values())l.reject(Fe)}),new Promise(l=>{function u(c){function v(){c===i?l(s):u(i)}c.then(v,v)}u(i)})}function re(t){const e=Mt(t);return Rn(e),e}function Br(t){const e=Mt(t);return e.equals=un,e}function hn(t){var e=t.effects;if(e!==null){t.effects=null;for(var n=0;n<e.length;n+=1)G(e[n])}}function jr(t){for(var e=t.parent;e!==null;){if((e.f&F)===0)return(e.f&we)===0?e:null;e=e.parent}return null}function Rt(t){var e,n=x;ce(jr(t));try{t.f&=~Ae,hn(t),e=Fn(t)}finally{ce(n)}return e}function _n(t){var e=Rt(t);if(t.equals(e)||(A?.is_fork||(t.v=e),t.wv=Nn()),!Ve)if(ee!==null)(Qe()||A?.is_fork)&&ee.set(t,e);else{var n=(t.f&se)===0?oe:L;z(t,n)}}let yt=new Set;const be=new Map;let pn=!1;function Me(t,e){var n={f:0,v:t,reactions:null,equals:fn,rv:0,wv:0};return n}function q(t,e){const n=Me(t);return Rn(n),n}function Vr(t,e=!1,n=!0){const r=Me(t);return e||(r.equals=un),r}function E(t,e,n=!1){w!==null&&(!ue||(w.f&jt)!==0)&&on()&&(w.f&(F|_e|At|jt))!==0&&!he?.includes(t)&&yr();let r=n?fe(e):e;return He(t,r)}function He(t,e){if(!t.equals(e)){var n=t.v;Ve?be.set(t,e):be.set(t,n),t.v=e;var r=le.ensure();r.capture(t,n),(t.f&F)!==0&&((t.f&K)!==0&&Rt(t),z(t,(t.f&se)!==0?L:oe)),t.wv=Nn(),gn(t,K),x!==null&&(x.f&L)!==0&&(x.f&(pe|Re))===0&&(Z===null?ni([t]):Z.push(t)),!r.is_fork&&yt.size>0&&!pn&&Gr()}return e}function Gr(){pn=!1;var t=Se;ut(!0);const e=Array.from(yt);try{for(const n of e)(n.f&L)!==0&&z(n,oe),rt(n)&&$e(n)}finally{ut(t)}yt.clear()}function Xe(t){E(t,t.v+1)}function gn(t,e){var n=t.reactions;if(n!==null)for(var r=n.length,i=0;i<r;i++){var s=n[i],a=s.f,f=(a&K)===0;if(f&&z(s,e),(a&F)!==0){var l=s;ee?.delete(l),(a&Ae)===0&&(a&se&&(s.f|=Ae),gn(l,oe))}else f&&((a&_e)!==0&&de!==null&&de.add(s),qe(s))}}function fe(t){if(typeof t!="object"||t===null||st in t)return t;const e=rn(t);if(e!==lr&&e!==fr)return t;var n=new Map,r=nn(t),i=q(0),s=Ce,a=f=>{if(Ce===s)return f();var l=w,u=Ce;V(null),Yt(s);var c=f();return V(l),Yt(u),c};return r&&n.set("length",q(t.length)),new Proxy(t,{defineProperty(f,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&mr();var c=n.get(l);return c===void 0?c=a(()=>{var v=q(u.value);return n.set(l,v),v}):E(c,u.value,!0),!0},deleteProperty(f,l){var u=n.get(l);if(u===void 0){if(l in f){const c=a(()=>q(P));n.set(l,c),Xe(i)}}else E(u,P),Xe(i);return!0},get(f,l,u){if(l===st)return t;var c=n.get(l),v=l in f;if(c===void 0&&(!v||We(f,l)?.writable)&&(c=a(()=>{var h=fe(v?f[l]:P),y=q(h);return y}),n.set(l,c)),c!==void 0){var o=d(c);return o===P?void 0:o}return Reflect.get(f,l,u)},getOwnPropertyDescriptor(f,l){var u=Reflect.getOwnPropertyDescriptor(f,l);if(u&&"value"in u){var c=n.get(l);c&&(u.value=d(c))}else if(u===void 0){var v=n.get(l),o=v?.v;if(v!==void 0&&o!==P)return{enumerable:!0,configurable:!0,value:o,writable:!0}}return u},has(f,l){if(l===st)return!0;var u=n.get(l),c=u!==void 0&&u.v!==P||Reflect.has(f,l);if(u!==void 0||x!==null&&(!c||We(f,l)?.writable)){u===void 0&&(u=a(()=>{var o=c?fe(f[l]):P,h=q(o);return h}),n.set(l,u));var v=d(u);if(v===P)return!1}return c},set(f,l,u,c){var v=n.get(l),o=l in f;if(r&&l==="length")for(var h=u;h<v.v;h+=1){var y=n.get(h+"");y!==void 0?E(y,P):h in f&&(y=a(()=>q(P)),n.set(h+"",y))}if(v===void 0)(!o||We(f,l)?.writable)&&(v=a(()=>q(void 0)),E(v,fe(u)),n.set(l,v));else{o=v.v!==P;var R=a(()=>fe(u));E(v,R)}var _=Reflect.getOwnPropertyDescriptor(f,l);if(_?.set&&_.set.call(c,u),!o){if(r&&typeof l=="string"){var g=n.get("length"),Y=Number(l);Number.isInteger(Y)&&Y>=g.v&&E(g,Y+1)}Xe(i)}return!0},ownKeys(f){d(i);var l=Reflect.ownKeys(f).filter(v=>{var o=n.get(v);return o===void 0||o.v!==P});for(var[u,c]of n)c.v!==P&&!(u in f)&&l.push(u);return l},setPrototypeOf(){wr()}})}var Gt,mn,wn,yn;function Kr(){if(Gt===void 0){Gt=window,mn=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,n=Text.prototype;wn=We(e,"firstChild").get,yn=We(e,"nextSibling").get,Bt(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Bt(n)&&(n.__t=void 0)}}function Ee(t=""){return document.createTextNode(t)}function ft(t){return wn.call(t)}function nt(t){return yn.call(t)}function m(t,e){return ft(t)}function _t(t,e=!1){{var n=ft(t);return n instanceof Comment&&n.data===""?nt(n):n}}function M(t,e=1,n=!1){let r=t;for(;e--;)r=nt(r);return r}function Yr(t){t.textContent=""}function bn(){return!1}function Dt(t){var e=w,n=x;V(null),ce(null);try{return t()}finally{V(e),ce(n)}}function Wr(t){x===null&&(w===null&&pr(),_r()),Ve&&hr()}function Xr(t,e){var n=e.last;n===null?e.last=e.first=t:(n.next=t,t.prev=n,e.last=t)}function ge(t,e,n){var r=x;r!==null&&(r.f&J)!==0&&(t|=J);var i={ctx:te,deps:null,nodes:null,f:t|K|se,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(n)try{$e(i),i.f|=Ct}catch(f){throw G(i),f}else e!==null&&qe(i);var s=i;if(n&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&Be)===0&&(s=s.first,(t&_e)!==0&&(t&Le)!==0&&s!==null&&(s.f|=Le)),s!==null&&(s.parent=r,r!==null&&Xr(s,r),w!==null&&(w.f&F)!==0&&(t&Re)===0)){var a=w;(a.effects??=[]).push(s)}return i}function Qe(){return w!==null&&!ue}function En(t){const e=ge(St,null,!1);return z(e,L),e.teardown=t,e}function Jr(t){Wr();var e=x.f,n=!w&&(e&pe)!==0&&(e&Ct)===0;if(n){var r=te;(r.e??=[]).push(t)}else return xn(t)}function xn(t){return ge(Tt|cr,t,!1)}function Qr(t){le.ensure();const e=ge(Re|Be,t,!0);return(n={})=>new Promise(r=>{n.outro?Te(e,()=>{G(e),r(void 0)}):(G(e),r(void 0))})}function Zr(t){return ge(Tt,t,!1)}function $r(t){return ge(At|Be,t,!0)}function kn(t,e=0){return ge(St|e,t,!0)}function ie(t,e=[],n=[],r=[]){zr(r,e,n,i=>{ge(St,()=>t(...i.map(d)),!0)})}function Nt(t,e=0){var n=ge(_e|e,t,!0);return n}function $(t){return ge(pe|Be,t,!0)}function Tn(t){var e=t.teardown;if(e!==null){const n=Ve,r=w;Kt(!0),V(null);try{e.call(null)}finally{Kt(n),V(r)}}}function Sn(t,e=!1){var n=t.first;for(t.first=t.last=null;n!==null;){const i=n.ac;i!==null&&Dt(()=>{i.abort(Fe)});var r=n.next;(n.f&Re)!==0?n.parent=null:G(n,e),n=r}}function ei(t){for(var e=t.first;e!==null;){var n=e.next;(e.f&pe)===0&&G(e),e=n}}function G(t,e=!0){var n=!1;(e||(t.f&an)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(ti(t.nodes.start,t.nodes.end),n=!0),Sn(t,e&&!n),ot(t,0),z(t,we);var r=t.nodes&&t.nodes.t;if(r!==null)for(const s of r)s.stop();Tn(t);var i=t.parent;i!==null&&i.first!==null&&Cn(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function ti(t,e){for(;t!==null;){var n=t===e?null:nt(t);t.remove(),t=n}}function Cn(t){var e=t.parent,n=t.prev,r=t.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=n))}function Te(t,e,n=!0){var r=[];An(t,r,!0);var i=()=>{n&&G(t),e&&e()},s=r.length;if(s>0){var a=()=>--s||i();for(var f of r)f.out(a)}else i()}function An(t,e,n){if((t.f&J)===0){t.f^=J;var r=t.nodes&&t.nodes.t;if(r!==null)for(const f of r)(f.is_global||n)&&e.push(f);for(var i=t.first;i!==null;){var s=i.next,a=(i.f&Le)!==0||(i.f&pe)!==0&&(t.f&_e)!==0;An(i,e,a?n:!1),i=s}}}function Ot(t){qn(t,!0)}function qn(t,e){if((t.f&J)!==0){t.f^=J,(t.f&L)===0&&(z(t,K),qe(t));for(var n=t.first;n!==null;){var r=n.next,i=(n.f&Le)!==0||(n.f&pe)!==0;qn(n,i?e:!1),n=r}var s=t.nodes&&t.nodes.t;if(s!==null)for(const a of s)(a.is_global||e)&&a.in()}}function Mn(t,e){if(t.nodes)for(var n=t.nodes.start,r=t.nodes.end;n!==null;){var i=n===r?null:nt(n);e.append(n),n=i}}let Se=!1;function ut(t){Se=t}let Ve=!1;function Kt(t){Ve=t}let w=null,ue=!1;function V(t){w=t}let x=null;function ce(t){x=t}let he=null;function Rn(t){w!==null&&(he===null?he=[t]:he.push(t))}let H=null,X=0,Z=null;function ni(t){Z=t}let Dn=1,Ze=0,Ce=Ze;function Yt(t){Ce=t}function Nn(){return++Dn}function rt(t){var e=t.f;if((e&K)!==0)return!0;if(e&F&&(t.f&=~Ae),(e&oe)!==0){var n=t.deps;if(n!==null)for(var r=n.length,i=0;i<r;i++){var s=n[i];if(rt(s)&&_n(s),s.wv>t.wv)return!0}(e&se)!==0&&ee===null&&z(t,L)}return!1}function On(t,e,n=!0){var r=t.reactions;if(r!==null&&!he?.includes(t))for(var i=0;i<r.length;i++){var s=r[i];(s.f&F)!==0?On(s,e,!1):e===s&&(n?z(s,K):(s.f&L)!==0&&z(s,oe),qe(s))}}function Fn(t){var e=H,n=X,r=Z,i=w,s=he,a=te,f=ue,l=Ce,u=t.f;H=null,X=0,Z=null,w=(u&(pe|Re))===0?t:null,he=null,ze(t.ctx),ue=!1,Ce=++Ze,t.ac!==null&&(Dt(()=>{t.ac.abort(Fe)}),t.ac=null);try{t.f|=mt;var c=t.fn,v=c(),o=t.deps;if(H!==null){var h;if(ot(t,X),o!==null&&X>0)for(o.length=X+H.length,h=0;h<H.length;h++)o[X+h]=H[h];else t.deps=o=H;if(Qe()&&(t.f&se)!==0)for(h=X;h<o.length;h++)(o[h].reactions??=[]).push(t)}else o!==null&&X<o.length&&(ot(t,X),o.length=X);if(on()&&Z!==null&&!ue&&o!==null&&(t.f&(F|oe|K))===0)for(h=0;h<Z.length;h++)On(Z[h],t);return i!==null&&i!==t&&(Ze++,Z!==null&&(r===null?r=Z:r.push(...Z))),(t.f&ye)!==0&&(t.f^=ye),v}catch(y){return cn(y)}finally{t.f^=mt,H=e,X=n,Z=r,w=i,he=s,ze(a),ue=f,Ce=l}}function ri(t,e){let n=e.reactions;if(n!==null){var r=ir.call(n,t);if(r!==-1){var i=n.length-1;i===0?n=e.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(e.f&F)!==0&&(H===null||!H.includes(e))&&(z(e,oe),(e.f&se)!==0&&(e.f^=se,e.f&=~Ae),hn(e),ot(e,0))}function ot(t,e){var n=t.deps;if(n!==null)for(var r=e;r<n.length;r++)ri(t,n[r])}function $e(t){var e=t.f;if((e&we)===0){z(t,L);var n=x,r=Se;x=t,Se=!0;try{(e&(_e|or))!==0?ei(t):Sn(t),Tn(t);var i=Fn(t);t.teardown=typeof i=="function"?i:null,t.wv=Dn;var s;gt&&Rr&&(t.f&K)!==0&&t.deps}finally{Se=r,x=n}}}function d(t){var e=t.f,n=(e&F)!==0;if(w!==null&&!ue){var r=x!==null&&(x.f&we)!==0;if(!r&&!he?.includes(t)){var i=w.deps;if((w.f&mt)!==0)t.rv<Ze&&(t.rv=Ze,H===null&&i!==null&&i[X]===t?X++:H===null?H=[t]:H.includes(t)||H.push(t));else{(w.deps??=[]).push(t);var s=t.reactions;s===null?t.reactions=[w]:s.includes(w)||s.push(w)}}}if(Ve){if(be.has(t))return be.get(t);if(n){var a=t,f=a.v;return((a.f&L)===0&&a.reactions!==null||Pn(a))&&(f=Rt(a)),be.set(a,f),f}}else n&&(!ee?.has(t)||A?.is_fork&&!Qe())&&(a=t,rt(a)&&_n(a),Se&&Qe()&&(a.f&se)===0&&In(a));if(ee?.has(t))return ee.get(t);if((t.f&ye)!==0)throw t.v;return t.v}function In(t){if(t.deps!==null){t.f^=se;for(const e of t.deps)(e.reactions??=[]).push(t),(e.f&F)!==0&&(e.f&se)===0&&In(e)}}function Pn(t){if(t.v===P)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(be.has(e)||(e.f&F)!==0&&Pn(e))return!0;return!1}function Ln(t){var e=ue;try{return ue=!0,t()}finally{ue=e}}const ii=-7169;function z(t,e){t.f=t.f&ii|e}const si=["touchstart","touchmove"];function ai(t){return si.includes(t)}const zn=new Set,bt=new Set;function li(t,e,n,r={}){function i(s){if(r.capture||Ge.call(e,s),!s.cancelBubble)return Dt(()=>n?.call(this,s))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?je(()=>{e.addEventListener(t,i,r)}):e.addEventListener(t,i,r),i}function fi(t,e,n,r,i){var s={capture:r,passive:i},a=li(t,e,n,s);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&En(()=>{e.removeEventListener(t,a,s)})}function Un(t){for(var e=0;e<t.length;e++)zn.add(t[e]);for(var n of bt)n(t)}let Wt=null;function Ge(t){var e=this,n=e.ownerDocument,r=t.type,i=t.composedPath?.()||[],s=i[0]||t.target;Wt=t;var a=0,f=Wt===t&&t.__root;if(f){var l=i.indexOf(f);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var u=i.indexOf(e);if(u===-1)return;l<=u&&(a=l)}if(s=i[a]||t.target,s!==e){sr(t,"currentTarget",{configurable:!0,get(){return s||n}});var c=w,v=x;V(null),ce(null);try{for(var o,h=[];s!==null;){var y=s.assignedSlot||s.parentNode||s.host||null;try{var R=s["__"+r];R!=null&&(!s.disabled||t.target===s)&&R.call(s,t)}catch(_){o?h.push(_):o=_}if(t.cancelBubble||y===e||y===null)break;s=y}if(o){for(let _ of h)queueMicrotask(()=>{throw _});throw o}}finally{t.__root=e,delete t.currentTarget,V(c),ce(v)}}}function ui(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function Et(t,e){var n=x;n.nodes===null&&(n.nodes={start:t,end:e,a:null,t:null})}function U(t,e){var n=(e&Sr)!==0,r=(e&Cr)!==0,i,s=!t.startsWith("<!>");return()=>{i===void 0&&(i=ui(s?t:"<!>"+t),n||(i=ft(i)));var a=r||mn?document.importNode(i,!0):i.cloneNode(!0);if(n){var f=ft(a),l=a.lastChild;Et(f,l)}else Et(a,a);return a}}function Xt(t=""){{var e=Ee(t+"");return Et(e,e),e}}function N(t,e){t!==null&&t.before(e)}function j(t,e){var n=e==null?"":typeof e=="object"?e+"":e;n!==(t.__t??=t.nodeValue)&&(t.__t=n,t.nodeValue=n+"")}function oi(t,e){return ci(t,e)}const Ne=new Map;function ci(t,{target:e,anchor:n,props:r={},events:i,context:s,intro:a=!0}){Kr();var f=new Set,l=v=>{for(var o=0;o<v.length;o++){var h=v[o];if(!f.has(h)){f.add(h);var y=ai(h);e.addEventListener(h,Ge,{passive:y});var R=Ne.get(h);R===void 0?(document.addEventListener(h,Ge,{passive:y}),Ne.set(h,1)):Ne.set(h,R+1)}}};l(ct(zn)),bt.add(l);var u=void 0,c=Qr(()=>{var v=n??e.appendChild(Ee());return Pr(v,{pending:()=>{}},o=>{if(s){et({});var h=te;h.c=s}i&&(r.$$events=i),u=t(o,r)||{},s&&tt()}),()=>{for(var o of f){e.removeEventListener(o,Ge);var h=Ne.get(o);--h===0?(document.removeEventListener(o,Ge),Ne.delete(o)):Ne.set(o,h)}bt.delete(l),v!==n&&v.parentNode?.removeChild(v)}});return di.set(u,c),u}let di=new WeakMap;class vi{anchor;#e=new Map;#t=new Map;#n=new Map;#r=new Set;#l=!0;constructor(e,n=!0){this.anchor=e,this.#l=n}#s=()=>{var e=A;if(this.#e.has(e)){var n=this.#e.get(e),r=this.#t.get(n);if(r)Ot(r),this.#r.delete(n);else{var i=this.#n.get(n);i&&(this.#t.set(n,i.effect),this.#n.delete(n),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),r=i.effect)}for(const[s,a]of this.#e){if(this.#e.delete(s),s===e)break;const f=this.#n.get(a);f&&(G(f.effect),this.#n.delete(a))}for(const[s,a]of this.#t){if(s===n||this.#r.has(s))continue;const f=()=>{if(Array.from(this.#e.values()).includes(s)){var u=document.createDocumentFragment();Mn(a,u),u.append(Ee()),this.#n.set(s,{effect:a,fragment:u})}else G(a);this.#r.delete(s),this.#t.delete(s)};this.#l||!r?(this.#r.add(s),Te(a,f,!1)):f()}}};#i=e=>{this.#e.delete(e);const n=Array.from(this.#e.values());for(const[r,i]of this.#n)n.includes(r)||(G(i.effect),this.#n.delete(r))};ensure(e,n){var r=A,i=bn();if(n&&!this.#t.has(e)&&!this.#n.has(e))if(i){var s=document.createDocumentFragment(),a=Ee();s.append(a),this.#n.set(e,{effect:$(()=>n(a)),fragment:s})}else this.#t.set(e,$(()=>n(this.anchor)));if(this.#e.set(r,e),i){for(const[f,l]of this.#t)f===e?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[f,l]of this.#n)f===e?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#s),r.ondiscard(this.#i)}else this.#s()}}function Oe(t,e,n=!1){var r=new vi(t),i=n?Le:0;function s(a,f){r.ensure(a,f)}Nt(()=>{var a=!1;e((f,l=!0)=>{a=!0,s(l,f)}),a||s(!1,null)},i)}function xt(t,e){return e}function hi(t,e,n){for(var r=[],i=e.length,s,a=e.length,f=0;f<i;f++){let v=e[f];Te(v,()=>{if(s){if(s.pending.delete(v),s.done.add(v),s.pending.size===0){var o=t.outrogroups;kt(ct(s.done)),o.delete(s),o.size===0&&(t.outrogroups=null)}}else a-=1},!1)}if(a===0){var l=r.length===0&&n!==null;if(l){var u=n,c=u.parentNode;Yr(c),c.append(u),t.items.clear()}kt(e,!l)}else s={pending:new Set(e),done:new Set},(t.outrogroups??=new Set).add(s)}function kt(t,e=!0){for(var n=0;n<t.length;n++)G(t[n],e)}var Jt;function Je(t,e,n,r,i,s=null){var a=t,f=new Map,l=(e&ln)!==0;if(l){var u=t;a=u.appendChild(Ee())}var c=null,v=Br(()=>{var g=n();return nn(g)?g:g==null?[]:ct(g)}),o,h=!0;function y(){_.fallback=c,_i(_,o,a,e,r),c!==null&&(o.length===0?(c.f&ve)===0?Ot(c):(c.f^=ve,Ke(c,null,a)):Te(c,()=>{c=null}))}var R=Nt(()=>{o=d(v);for(var g=o.length,Y=new Set,O=A,W=bn(),ne=0;ne<g;ne+=1){var b=o[ne],k=r(b,ne),T=h?null:f.get(k);T?(T.v&&He(T.v,b),T.i&&He(T.i,ne),W&&O.skipped_effects.delete(T.e)):(T=pi(f,h?a:Jt??=Ee(),b,k,ne,i,e,n),h||(T.e.f|=ve),f.set(k,T)),Y.add(k)}if(g===0&&s&&!c&&(h?c=$(()=>s(a)):(c=$(()=>s(Jt??=Ee())),c.f|=ve)),!h)if(W){for(const[Q,I]of f)Y.has(Q)||O.skipped_effects.add(I.e);O.oncommit(y),O.ondiscard(()=>{})}else y();d(v)}),_={effect:R,items:f,outrogroups:null,fallback:c};h=!1}function _i(t,e,n,r,i){var s=(r&kr)!==0,a=e.length,f=t.items,l=t.effect.first,u,c=null,v,o=[],h=[],y,R,_,g;if(s)for(g=0;g<a;g+=1)y=e[g],R=i(y,g),_=f.get(R).e,(_.f&ve)===0&&(_.nodes?.a?.measure(),(v??=new Set).add(_));for(g=0;g<a;g+=1){if(y=e[g],R=i(y,g),_=f.get(R).e,t.outrogroups!==null)for(const I of t.outrogroups)I.pending.delete(_),I.done.delete(_);if((_.f&ve)!==0)if(_.f^=ve,_===l)Ke(_,null,n);else{var Y=c?c.next:l;_===t.effect.last&&(t.effect.last=_.prev),_.prev&&(_.prev.next=_.next),_.next&&(_.next.prev=_.prev),me(t,c,_),me(t,_,Y),Ke(_,Y,n),c=_,o=[],h=[],l=c.next;continue}if((_.f&J)!==0&&(Ot(_),s&&(_.nodes?.a?.unfix(),(v??=new Set).delete(_))),_!==l){if(u!==void 0&&u.has(_)){if(o.length<h.length){var O=h[0],W;c=O.prev;var ne=o[0],b=o[o.length-1];for(W=0;W<o.length;W+=1)Ke(o[W],O,n);for(W=0;W<h.length;W+=1)u.delete(h[W]);me(t,ne.prev,b.next),me(t,c,ne),me(t,b,O),l=O,c=b,g-=1,o=[],h=[]}else u.delete(_),Ke(_,l,n),me(t,_.prev,_.next),me(t,_,c===null?t.effect.first:c.next),me(t,c,_),c=_;continue}for(o=[],h=[];l!==null&&l!==_;)(u??=new Set).add(l),h.push(l),l=l.next;if(l===null)continue}(_.f&ve)===0&&o.push(_),c=_,l=_.next}if(t.outrogroups!==null){for(const I of t.outrogroups)I.pending.size===0&&(kt(ct(I.done)),t.outrogroups?.delete(I));t.outrogroups.size===0&&(t.outrogroups=null)}if(l!==null||u!==void 0){var k=[];if(u!==void 0)for(_ of u)(_.f&J)===0&&k.push(_);for(;l!==null;)(l.f&J)===0&&l!==t.fallback&&k.push(l),l=l.next;var T=k.length;if(T>0){var Q=(r&ln)!==0&&a===0?n:null;if(s){for(g=0;g<T;g+=1)k[g].nodes?.a?.measure();for(g=0;g<T;g+=1)k[g].nodes?.a?.fix()}hi(t,k,Q)}}s&&je(()=>{if(v!==void 0)for(_ of v)_.nodes?.a?.apply()})}function pi(t,e,n,r,i,s,a,f){var l=(a&Er)!==0?(a&Tr)===0?Vr(n,!1,!1):Me(n):null,u=(a&xr)!==0?Me(i):null;return{v:l,i:u,e:$(()=>(s(e,l??n,u??i,f),()=>{t.delete(r)}))}}function Ke(t,e,n){if(t.nodes)for(var r=t.nodes.start,i=t.nodes.end,s=e&&(e.f&ve)===0?e.nodes.start:n;r!==null;){var a=nt(r);if(s.before(r),r===i)return;r=a}}function me(t,e,n){e===null?t.effect.first=n:e.next=n,n===null?t.effect.last=e:n.prev=e}const Qt=[...` 	
\r\fÂ \v\uFEFF`];function gi(t,e,n){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var s=i.length,a=0;(a=r.indexOf(i,a))>=0;){var f=a+s;(a===0||Qt.includes(r[a-1]))&&(f===r.length||Qt.includes(r[f]))?r=(a===0?"":r.substring(0,a))+r.substring(f+1):a=f}}return r===""?null:r}function Pe(t,e,n,r,i,s){var a=t.__className;if(a!==n||a===void 0){var f=gi(n,r,s);f==null?t.removeAttribute("class"):t.className=f,t.__className=n}else if(s&&i!==s)for(var l in s){var u=!!s[l];(i==null||u!==!!i[l])&&t.classList.toggle(l,u)}return s}const mi=Symbol("is custom element"),wi=Symbol("is html");function at(t,e,n,r){var i=yi(t);i[e]!==(i[e]=n)&&(e==="loading"&&(t[dr]=n),n==null?t.removeAttribute(e):typeof n!="string"&&bi(t).includes(e)?t[e]=n:t.setAttribute(e,n))}function yi(t){return t.__attributes??={[mi]:t.nodeName.includes("-"),[wi]:t.namespaceURI===Ar}}var Zt=new Map;function bi(t){var e=t.getAttribute("is")||t.nodeName,n=Zt.get(e);if(n)return n;Zt.set(e,n=[]);for(var r,i=t,s=Element.prototype;s!==i;){r=ar(i);for(var a in r)r[a].set&&n.push(a);i=rn(i)}return n}function $t(t,e){return t===e||t?.[st]===e}function Ei(t={},e,n,r){return Zr(()=>{var i,s;return kn(()=>{i=s,s=[],Ln(()=>{t!==n(...s)&&(e(t,...s),i&&$t(n(...i),t)&&e(null,...i))})}),()=>{je(()=>{s&&$t(n(...s),t)&&e(null,...s)})}}),t}const xi="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(xi);class ki{#e=q(4);get current(){return d(this.#e)}set current(e){E(this.#e,e,!0)}#t=q(4);get max(){return d(this.#t)}set max(e){E(this.#t,e,!0)}constructor(e=4){this.current=e,this.max=e}damage(e){this.current-=e,this.current<0&&(this.current=0)}recover(e){this.current<this.max&&(this.current+=e)}#n=re(()=>this.current<=0);get isDying(){return d(this.#n)}set isDying(e){E(this.#n,e)}}class Ti{characters=new Map;skills=new Map;register(e){console.log(`[Debug] æ³¨å†Œ Mod: ${e.id}, åŒ…å«æŠ€èƒ½æ•°: ${e.skills?.length||0}`),e.characters.forEach(n=>this.characters.set(n.id,n)),e.skills&&e.skills.forEach(n=>this.skills.set(n.id,n))}getSkill(e){return this.skills.get(e)}getCharacter(e){return this.characters.get(e)}getAllCharacters(){return Array.from(this.characters.values())}}const Ye=new Ti;class Si{#e=q(fe([]));get entries(){return d(this.#e)}set entries(e){E(this.#e,e,!0)}add(...e){const n=e.map(i=>typeof i=="string"?{text:i,type:"normal"}:i),r={id:Math.random().toString(36).slice(2),timestamp:Date.now(),segments:n};this.entries.push(r),this.entries.length>50&&this.entries.shift()}player(e){return{text:`[${e.name}]`,type:"player",id:e.id}}card(e){return{text:`ã€${e}ã€‘`,type:"card"}}skill(e){return{text:`ã€${e}ã€`,type:"skill"}}}const p=new Si;class en{uid=Math.random().toString(36).slice(2);id;#e=q("");get name(){return d(this.#e)}set name(e){E(this.#e,e,!0)}#t=q("");get country(){return d(this.#t)}set country(e){E(this.#t,e,!0)}health;#n=q(fe([]));get hand(){return d(this.#n)}set hand(e){E(this.#n,e,!0)}#r=q(fe([]));get skills(){return d(this.#r)}set skills(e){E(this.#r,e,!0)}constructor(e){this.id=e.id,this.name=e.name,this.country=e.country,this.health=new ki(e.maxHp),e.skills&&e.skills.forEach(n=>{const r=Ye.getSkill(n);console.log(`[Debug] æ­¦å°† ${this.name} å°è¯•åŠ è½½æŠ€èƒ½: ${n}, ç»“æœ:`,r),r&&this.skills.push(r)}),console.log("[Debug] æŠ€èƒ½åˆ—è¡¨:",this.skills.map(n=>n.name))}async damage(e=1){const n={target:this,amount:e};for(const r of this.skills)r.hooks?.onBeforeDamage&&(console.log(`[Engine] è§¦å‘æŠ€èƒ½: ${r.name}`),r.hooks.onBeforeDamage(n));n.amount>0?(this.health.damage(n.amount),p.add(p.player(this)," å—åˆ°äº† ",{text:`${n.amount}ç‚¹`,type:"damage"}," ä¼¤å®³"),this.health.current<=0&&(await C.handleDying(this)||C.handleDeath(this))):p.add(p.player(this)," çš„ä¼¤å®³è¢«é˜²æ­¢äº†")}drawCard(){const e=["æ€","é—ª","æ¡ƒ","é…’"],n=["spade","heart","club","diamond"],r={id:Math.random().toString(36).slice(2),name:e[Math.floor(Math.random()*e.length)],suit:n[Math.floor(Math.random()*n.length)],point:Math.floor(Math.random()*13)+1,type:"basic"};this.hand.push(r)}}const pt=t=>new Promise(e=>setTimeout(e,t));class Ci{#e=q(fe([]));get players(){return d(this.#e)}set players(e){E(this.#e,e,!0)}#t=q(null);get winner(){return d(this.#t)}set winner(e){E(this.#t,e,!0)}#n=q("");get currentTurnUid(){return d(this.#n)}set currentTurnUid(e){E(this.#n,e,!0)}#r=q(null);get pendingRequest(){return d(this.#r)}set pendingRequest(e){E(this.#r,e,!0)}#l=re(()=>this.players[0]);get me(){return d(this.#l)}set me(e){E(this.#l,e)}get currentTurnPlayer(){return this.players.find(e=>e.uid===this.currentTurnUid)}start(e,n){const r=new en(e),i=new en(n);for(let s=0;s<4;s++)r.drawCard(),i.drawCard();this.players=[r,i],this.currentTurnUid=r.uid,p.add("æ¸¸æˆå¼€å§‹ï¼"),this.startTurn(r)}async startTurn(e){p.add(`
--- è½®åˆ° [${e.name}] çš„å›åˆ ---`),await pt(500),e.drawCard(),e.drawCard(),p.add(p.player(e)," æ‘¸äº†ä¸¤å¼ ç‰Œ"),e!==this.me&&await this.aiAct(e)}async nextTurn(){const n=(this.players.findIndex(i=>i.uid===this.currentTurnUid)+1)%this.players.length,r=this.players[n];this.currentTurnUid=r.uid,await this.startTurn(r)}async aiAct(e){await pt(1e3);const n=e.hand.find(i=>i.name==="æ€"),r=this.me;n?(console.log("AI å†³å®šå‡ºæ€..."),await this.useCard(n.id,r.uid)):p.add(p.player(e)," å¾®å¾®ä¸€ç¬‘ï¼Œæ²¡æœ‰å‡ºç‰Œ"),await pt(1e3),this.nextTurn()}async useCard(e,n){const r=this.currentTurnPlayer;if(!r)return;const i=r.hand.find(a=>a.id===e);if(!i)return;let s;if(n&&(s=this.players.find(a=>a.uid===n)),r.hand=r.hand.filter(a=>a.id!==e),i.name==="æ€"){if(!s)return;p.add(p.player(r)," å¯¹ ",p.player(s)," ä½¿ç”¨äº† ",p.card(i.name)),await this.askForCard(s,"é—ª")?p.add(p.card("æ€")," è¢«æŠµæ¶ˆäº†"):await s.damage(1)}else i.name==="æ¡ƒ"&&(r.health.recover(1),p.add(p.player(r)," åƒäº†ä¸€ä¸ª ",p.card("æ¡ƒ")))}async askForCard(e,n){if(p.add(`ç­‰å¾… [${e.name}] æ‰“å‡º ã€${n}ã€‘...`),e!==this.me){await new Promise(i=>setTimeout(i,1e3));const r=e.hand.find(i=>i.name===n);return r?(e.hand=e.hand.filter(i=>i.id!==r.id),p.add(p.player(e)," æ‰“å‡ºäº† ",p.card(n)),!0):!1}return new Promise(r=>{this.pendingRequest={playerId:e.uid,cardName:n,resolve:i=>{this.pendingRequest=null,r(i)}}})}respondCard(e){if(!this.pendingRequest)return;const n=this.me;if(e){const r=n.hand.find(i=>i.id===e);if(r&&r.name===this.pendingRequest.cardName){n.hand=n.hand.filter(i=>i.id!==e),p.add(p.player(n)," æ‰“å‡ºäº† ",p.card(r.name)),this.pendingRequest.resolve(!0);return}}p.add(p.player(n)," é€‰æ‹©ä¸æ‰“å‡º"),this.pendingRequest.resolve(!1)}async handleDying(e){for(p.add(p.player(e)," è¿›å…¥æ¿’æ­»çŠ¶æ€ï¼");e.health.current<=0&&await this.askForCard(e,"æ¡ƒ");)e.health.recover(1),p.add(p.player(e)," æ¿’æ­»å›å¤è‡³ ",`${e.health.current}ç‚¹`);return e.health.current>0}handleDeath(e,n){p.add(p.player(e)," é˜µäº¡äº†ï¼"),e===this.me?this.winner="å•å¸ƒ (ç”µè„‘)":this.winner="ä½ "}}const C=new Ci,Ai={id:"standard_pack",skills:[{id:"tiebi",name:"é“å£",description:"è¢«åŠ¨æŠ€ï¼Œå—åˆ°çš„ä¼¤å®³ -1",hooks:{onBeforeDamage:t=>{t.amount-=1,t.amount<0&&(t.amount=0),p.add(p.skill("é“å£")," è§¦å‘ï¼ŒæŠµæ¶ˆäº† 1 ç‚¹ä¼¤å®³")}}}],characters:[{id:"caocao",name:"æ›¹æ“",maxHp:4,country:"wei",skills:["tiebi"]},{id:"liubei",name:"åˆ˜å¤‡",maxHp:1,country:"shu"},{id:"sunquan",name:"å­™æƒ",maxHp:4,country:"wu"},{id:"lvbu",name:"å•å¸ƒ",maxHp:1,country:"qun"}]},qi="https://cdn.jsdelivr.net/gh/pseudo777/noname-assets@main",Mi={getUrl(t){const e=t.startsWith("/")?t.slice(1):t;return`${qi}/${e}`},getCharacterAvatar(t){return this.getUrl(`characters/${t}.jpg`)},getCardImage(t){return this.getUrl(`cards/${t}.png`)}};var Ri=U('<img draggable="false" class="svelte-lfzw0s"/>'),Di=U('<div class="fallback svelte-lfzw0s"> </div>'),Ni=U('<div><!> <div class="country-tag svelte-lfzw0s"> </div></div>');function tn(t,e){et(e,!0);let n=re(()=>Mi.getCharacterAvatar(e.player.id)),r=q(!1);var i=Ni();let s;var a=m(i);{var f=v=>{var o=Ri();ie(()=>{at(o,"src",d(n)),at(o,"alt",e.player.name)}),fi("error",o,()=>E(r,!0)),N(v,o)},l=v=>{var o=Di(),h=m(o);ie(()=>j(h,e.player.name[0])),N(v,o)};Oe(a,v=>{d(r)?v(l,!1):v(f)})}var u=M(a,2),c=m(u);ie(v=>{s=Pe(i,1,"avatar-container svelte-lfzw0s",null,s,{dead:e.player.health.isDying}),at(u,"data-country",e.player.country),j(c,v)},[()=>e.player.country.toUpperCase()]),N(t,i),tt()}var Oi=U('<div role="button" tabindex="0"><div class="top-left svelte-1s7zazm"><div class="point svelte-1s7zazm"> </div> <div class="suit svelte-1s7zazm"> </div></div> <div class="name svelte-1s7zazm"> </div> <div class="bottom-right svelte-1s7zazm"> </div></div>');function Fi(t,e){et(e,!0);const n=re(()=>e.card.suit==="heart"||e.card.suit==="diamond"),r={spade:"â™ ",heart:"â™¥",club:"â™£",diamond:"â™¦"},i=re(()=>r[e.card.suit]),s={1:"A",11:"J",12:"Q",13:"K"},a=re(()=>s[e.card.point]||e.card.point.toString());function f(O){(O.key==="Enter"||O.key===" ")&&(O.preventDefault(),e.onclick())}var l=Oi();let u;l.__keydown=f,l.__click=function(...O){e.onclick?.apply(this,O)};var c=m(l),v=m(c),o=m(v),h=M(v,2),y=m(h),R=M(c,2),_=m(R),g=M(R,2),Y=m(g);ie(()=>{u=Pe(l,1,"card svelte-1s7zazm",null,u,{selected:e.selected,red:d(n)}),j(o,d(a)),j(y,d(i)),j(_,e.card.name),j(Y,d(i))}),N(t,l),tt()}Un(["keydown","click"]);var Ii=U("<span> </span>"),Pi=U('<div class="log-line svelte-1tqgy9c"><span class="time svelte-1tqgy9c"> </span> <!></div>'),Li=U('<div class="log-panel svelte-1tqgy9c"></div>');function zi(t,e){et(e,!0);let n;Jr(()=>{p.entries.length,n&&requestAnimationFrame(()=>{n.scrollTop=n.scrollHeight})});var r=Li();Je(r,21,()=>p.entries,i=>i.id,(i,s)=>{var a=Pi(),f=m(a),l=m(f),u=M(f,2);Je(u,17,()=>d(s).segments,xt,(c,v)=>{var o=Ii(),h=m(o);ie(()=>{Pe(o,1,`segment ${d(v).type??""}`,"svelte-1tqgy9c"),at(o,"title",d(v).id),j(h,d(v).text)}),N(c,o)}),ie(c=>j(l,c),[()=>new Date(d(s).timestamp).toLocaleTimeString().slice(0,8)]),N(i,a)}),Ei(r,i=>n=i,()=>n),N(t,r),tt()}var Ui=U('<div class="game-over-modal svelte-1n46o8q"><div class="modal-content svelte-1n46o8q"><h1 class="svelte-1n46o8q">æ¸¸æˆç»“æŸ</h1> <p class="winner-text svelte-1n46o8q"> </p> <button class="svelte-1n46o8q">å†æ¥ä¸€å±€</button></div></div>'),Hi=U('<button class="svelte-1n46o8q"> </button>'),Bi=U('<div class="lobby svelte-1n46o8q"><h2 class="svelte-1n46o8q">è¯·é€‰æ‹©ä½ çš„æ­¦å°†:</h2> <div class="char-grid svelte-1n46o8q"></div></div>'),ji=U('<div role="button" tabindex="0"><!> <div class="card-count svelte-1n46o8q"> </div></div>'),Vi=U('<div class="guide-text svelte-1n46o8q">è¯·é€‰æ‹©ä¸€åç›®æ ‡...</div> <button class="cancel-btn svelte-1n46o8q">å–æ¶ˆ</button>',1),Gi=U('<div class="ask-prompt svelte-1n46o8q"> </div> <button class="cancel-btn svelte-1n46o8q">å–æ¶ˆ / ä¸å‡º</button>',1),Ki=U('<button class="svelte-1n46o8q">æ‘¸ç‰Œ</button> <button class="use-btn svelte-1n46o8q">å‡ºç‰Œ</button> <button class="end-btn svelte-1n46o8q">ç»“æŸå›åˆ</button>',1),Yi=U('<div class="battle-container svelte-1n46o8q"><div class="arena svelte-1n46o8q"><div><!></div> <div class="enemies-row svelte-1n46o8q"></div> <div class="middle-zone svelte-1n46o8q"><!></div> <div><div class="player-header svelte-1n46o8q"><div role="button" tabindex="0" class="svelte-1n46o8q"><!></div> <div class="status-box svelte-1n46o8q"><h2 class="svelte-1n46o8q"> </h2> <div class="hp svelte-1n46o8q"> </div></div></div> <div class="hand-area svelte-1n46o8q"><div class="cards-list svelte-1n46o8q"></div></div> <div class="controls svelte-1n46o8q"><!></div></div></div> <div class="sidebar svelte-1n46o8q"><!></div></div>'),Wi=U('<main class="svelte-1n46o8q"><!> <!></main>');function Xi(t,e){et(e,!0),Ye.register(Ai);const n=Ye.getAllCharacters();let r=q(!0),i=q(fe(new Set)),s=q(!1),a=re(()=>!!C.pendingRequest),f=re(()=>d(a)?`è¯·æ‰“å‡ºä¸€å¼ ã€${C.pendingRequest?.cardName}ã€‘ä»¥å“åº”`:"");function l(b){const k=Ye.getCharacter(b),T=Ye.getCharacter("lvbu")||n[0];k&&T&&(C.start(k,T),E(r,!1))}let u=re(()=>C.currentTurnUid===C.me.uid);async function c(){if(d(a)||d(i).size===0)return;const b=Array.from(d(i))[0];C.me.hand.find(T=>T.id===b)?.name==="æ€"?E(s,!0):(await C.useCard(b),d(i).clear(),E(i,new Set(d(i)),!0))}function v(b){if(d(a)){b.name===C.pendingRequest?.cardName?C.respondCard(b.id):console.log("è¿™å¼ ç‰Œæ— æ³•å“åº”");return}d(i).has(b.id)?d(i).delete(b.id):(d(i).clear(),d(i).add(b.id)),E(i,new Set(d(i)),!0)}function o(b){if(d(s)){const k=Array.from(d(i))[0];C.useCard(k,b),E(s,!1),d(i).clear(),E(i,new Set(d(i)),!0)}}function h(){E(s,!1)}let y=re(()=>C.winner);function R(){window.location.reload()}var _=Wi(),g=m(_);{var Y=b=>{var k=Ui(),T=m(k),Q=M(m(T),2),I=m(Q),xe=M(Q,2);xe.__click=R,ie(()=>j(I,`è·èƒœè€…: ${d(y)??""}`)),N(b,k)};Oe(g,b=>{d(y)&&b(Y)})}var O=M(g,2);{var W=b=>{var k=Bi(),T=M(m(k),2);Je(T,21,()=>n,xt,(Q,I)=>{var xe=Hi();xe.__click=()=>l(d(I).id);var vt=m(xe);ie(()=>j(vt,d(I).name)),N(Q,xe)}),N(b,k)},ne=b=>{var k=Yi(),T=m(k),Q=m(T);let I;var xe=m(Q);{var vt=S=>{var D=Xt("ğŸŸ¢ ä½ çš„å›åˆ");N(S,D)},Hn=S=>{var D=Xt("ğŸ”´ æ•Œæ–¹è¡ŒåŠ¨ä¸­...");N(S,D)};Oe(xe,S=>{d(u)?S(vt):S(Hn,!1)})}var Ft=M(Q,2);Je(Ft,21,()=>C.players.filter(S=>S!==C.me),xt,(S,D)=>{var B=ji();let ke;B.__click=()=>o(d(D).uid);var De=m(B);tn(De,{get player(){return d(D)}});var nr=M(De,2),rr=m(nr);ie(()=>{ke=Pe(B,1,"enemy-slot svelte-1n46o8q",null,ke,{"valid-target":d(s)}),j(rr,`ğŸ´ ${d(D).hand.length??""}`)}),N(S,B)});var It=M(Ft,2),Bn=m(It);{var jn=S=>{var D=Vi(),B=M(_t(D),2);B.__click=h,N(S,D)};Oe(Bn,S=>{d(s)&&S(jn)})}var Pt=M(It,2);let Lt;var zt=m(Pt),ht=m(zt);ht.__click=()=>o(C.me.uid);var Vn=m(ht);tn(Vn,{get player(){return C.me}});var Gn=M(ht,2),Ut=m(Gn),Kn=m(Ut),Yn=M(Ut,2),Wn=m(Yn),Ht=M(zt,2),Xn=m(Ht);Je(Xn,21,()=>C.me.hand,S=>S.id,(S,D)=>{{let B=re(()=>d(i).has(d(D).id));Fi(S,{get card(){return d(D)},get selected(){return d(B)},onclick:()=>v(d(D))})}});var Jn=M(Ht,2),Qn=m(Jn);{var Zn=S=>{var D=Gi(),B=_t(D),ke=m(B),De=M(B,2);De.__click=()=>C.respondCard(void 0),ie(()=>j(ke,d(f))),N(S,D)},$n=S=>{var D=Ki(),B=_t(D);B.__click=()=>C.me.drawCard();var ke=M(B,2);ke.__click=c;var De=M(ke,2);De.__click=()=>C.nextTurn(),N(S,D)};Oe(Qn,S=>{d(a)?S(Zn):S($n,!1)})}var er=M(T,2),tr=m(er);zi(tr,{}),ie(()=>{I=Pe(Q,1,"turn-indicator svelte-1n46o8q",null,I,{"my-turn":d(u)}),Lt=Pe(Pt,1,"my-zone svelte-1n46o8q",null,Lt,{active:d(u),asking:d(a)}),j(Kn,C.me.name),j(Wn,`â¤ ${C.me.health.current??""}`)}),N(b,k)};Oe(O,b=>{d(r)?b(W):b(ne,!1)})}N(t,_),tt()}Un(["click"]);oi(Xi,{target:document.getElementById("app")});
